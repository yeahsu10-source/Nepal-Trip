<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nepal Trip - GitHub Ready</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=JetBrains+Mono:wght@500&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #fcf6f0; }
        .abc-header { background-color: #88292F; border-bottom: 4px solid #FFD700; }
        .date-font { font-family: 'JetBrains Mono', monospace; }
        .tool-card { @apply bg-white rounded-[2rem] shadow-xl border border-gray-100 overflow-hidden; }
        .input-field { @apply w-full p-3 bg-gray-50 border-2 border-transparent rounded-xl outline-none focus:border-orange-400 font-bold text-sm; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div id="app" class="max-w-6xl mx-auto space-y-8">
        
        <section class="abc-header p-8 rounded-[2rem] text-white shadow-2xl">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h1 class="text-3xl font-black flex items-center gap-2">ğŸ”ï¸ ABC æ¥µé™å¾’æ­¥</h1>
                    <p class="text-xs opacity-70">Interactive 3-Day Route</p>
                </div>
                <div class="flex gap-2">
                    <button onclick="showTrek(1)" class="bg-white text-red-900 px-4 py-1 rounded-full font-black text-xs">DAY 1</button>
                    <button onclick="showTrek(2)" class="bg-white/20 px-4 py-1 rounded-full font-black text-xs hover:bg-white/40">DAY 2</button>
                    <button onclick="showTrek(3)" class="bg-white/20 px-4 py-1 rounded-full font-black text-xs hover:bg-white/40">DAY 3</button>
                </div>
            </div>
            
            <div class="mb-10">
                <div class="flex items-center gap-3 mb-4">
                    <span class="bg-yellow-400 text-red-900 px-2 py-0.5 rounded-md font-black text-[10px]">ROUTE</span>
                    <h2 id="trek-title" class="text-xl font-bold">Jhinu â†’ Bamboo</h2>
                </div>
                <p id="trek-desc" class="text-sm opacity-90">é€”ç¶“ Chhomrong å¤§éšæ¢¯èˆ‡ Sinuwaã€‚é¦–æ—¥æµ·æ‹”çˆ¬å‡æ˜é¡¯ï¼Œéœ€æ³¨æ„ç¯€å¥ã€‚</p>
            </div>

            <div class="bg-black/20 p-6 rounded-2xl border border-white/10">
                <p class="text-[10px] font-black text-yellow-400 mb-4 tracking-widest">ğŸ“¡ å±±å±‹ WIFI & å¯†ç¢¼åƒè€ƒ</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-2 text-[11px]">
                    <div class="flex justify-between border-b border-white/10 pb-1"><span>Sinuwa:</span><span class="date-font font-bold">Sinuwaa123</span></div>
                    <div class="flex justify-between border-b border-white/10 pb-1"><span>Bamboo:</span><span class="date-font font-bold">Bamboo222</span></div>
                    <div class="flex justify-between border-b border-white/10 pb-1"><span>Himalaya:</span><span class="date-font font-bold">man9766027280</span></div>
                    <div class="flex justify-between border-b border-white/10 pb-1"><span>ABC Snowland:</span><span class="date-font font-bold">blacktea1234</span></div>
                    <div class="flex justify-between border-b border-white/10 pb-1 col-span-full"><span>Annapurna Guest:</span><span class="date-font font-bold">Jaganras7019</span></div>
                </div>
            </div>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2 space-y-8">
                <section class="bg-white p-8 rounded-[2.5rem] shadow-xl border-t-8 border-orange-500">
                    <h2 class="text-2xl font-black mb-6">ğŸ“… è¡Œç¨‹ç®¡ç†ä¸­å¿ƒ</h2>
                    <div id="itin-list" class="space-y-3"></div>
                </section>

                <div id="loc-container" class="space-y-8"></div>
            </div>

            <div class="space-y-8">
                <div class="tool-card p-6 border-t-8 border-blue-500">
                    <h3 class="font-black text-sm mb-4 text-blue-600">Wise Exchange (18.55)</h3>
                    <div class="space-y-3">
                        <input type="number" id="hkd-in" oninput="convert('HKD')" placeholder="HKD" class="input-field">
                        <input type="number" id="nrs-in" oninput="convert('NRs')" placeholder="NPR" class="input-field">
                    </div>
                </div>

                <div class="tool-card border-t-8 border-teal-600">
                    <div class="p-4 bg-teal-50 flex justify-between items-center">
                        <span class="font-black text-xs text-teal-800">EXPENSES</span>
                        <span id="exp-total" class="font-black text-teal-700">0 NPR</span>
                    </div>
                    <div class="p-6 space-y-3">
                        <input type="text" id="exp-item" placeholder="é …ç›®" class="input-field">
                        <input type="text" id="exp-use" placeholder="å‚™è¨»" class="input-field">
                        <input type="number" id="exp-amt" placeholder="é‡‘é¡" class="input-field">
                        <button onclick="addExp()" class="w-full bg-teal-700 text-white py-3 rounded-xl font-black text-xs">SAVE</button>
                        <div id="exp-history" class="space-y-2 mt-4 max-h-32 overflow-y-auto pr-2"></div>
                        <button onclick="resetExp()" class="w-full text-[10px] text-red-400 font-bold mt-2">RESET ALL</button>
                    </div>
                </div>

                <div class="tool-card border-t-8 border-yellow-500">
                    <div class="p-4 bg-yellow-50 font-black text-xs text-yellow-800">FILE VAULT</div>
                    <div class="p-6 space-y-3">
                        <div id="file-list" class="space-y-2 mb-2"></div>
                        <input type="text" id="file-name" placeholder="æ¨™ç±¤" class="input-field">
                        <input type="file" id="file-input" class="text-[10px] w-full">
                        <button onclick="uploadFile()" class="w-full bg-yellow-600 text-white py-3 rounded-xl font-black text-xs">UPLOAD</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const RATE = 18.55;
        const defaultItin = [
            { d: "12/19", e: "é¦™æ¸¯ â†’ æ˜†æ˜ (MU9658)", r: "21:15 å‡ºç™¼", done: false },
            { d: "12/20", e: "æ˜†æ˜ â†’ åŠ å¾·æ»¿éƒ½ (MU9617)", r: "è½‰é£›æ³¢å¡æ‹‰", done: false },
            { d: "12/21", e: "ABC D1 (Jhinu â†’ Bamboo)", r: "Jhinu âœ Chhomrong âœ Sinuwa", done: false },
            { d: "12/22", e: "ABC D2 (Bamboo â†’ ABC)", r: "æŠµé” 4130m å¤§æœ¬ç‡Ÿ", done: false },
            { d: "12/23", e: "ABC D3 (ABC â†’ ä¸‹æ’¤ â†’ è¿”å›æ³¢å¡æ‹‰)", r: "å‰æ™®è»Šå›åŸ", done: false },
            { d: "12/24", e: "æ³¢å¡æ‹‰ä¼‘æ¯æ—¥", r: "æ»‘ç¿”å‚˜ / è²»ç“¦æ¹–", done: false },
            { d: "12/25", e: "æ³¢å¡æ‹‰ â†’ åŠ å¾·æ»¿éƒ½", r: "åœ‹å…§é£›æ©Ÿ", done: false },
            { d: "12/26", e: "åŠ å¾·æ»¿éƒ½å¤åŸ", r: "çŒ´å»Ÿ / æœå·´å»£å ´", done: false },
            { d: "12/27", e: "å›ç¨‹ (MU9618)", r: "17:10 ç™»æ©Ÿ", done: false },
            { d: "12/28", e: "è¿”æŠµé¦™æ¸¯", r: "å®Œçµ", done: false }
        ];

        const SPOTS = [
            { c: 'Kathmandu', n: 'Mezze by Roadhouse', t: 'é¤å»³' }, { c: 'Kathmandu', n: 'Mazaaj Restaurant', t: 'ä¸­æ±èœ' },
            { c: 'Kathmandu', n: 'Yala Cafe', t: 'å’–å•¡åº—' }, { c: 'Kathmandu', n: 'Fresh Bake Thamel 1', t: 'çƒ˜ç„™' },
            { c: 'Kathmandu', n: 'Pilgrims Book House', t: 'æ›¸åº—' }, { c: 'Kathmandu', n: 'Barc', t: 'é…’å§' },
            { c: 'Pokhara', n: 'The Juicery Cafe', t: 'å’–å•¡åº—' }, { c: 'Pokhara', n: 'Taiwan Cafe', t: 'å°ç£æ–™ç†' },
            { c: 'Pokhara', n: 'Cafe Camellia', t: 'ç²¾å“å’–å•¡' }, { c: 'Bhaktapur', n: 'The Peacock Shop', t: 'ç‰¹è‰²ç´™å“' }
        ];

        const TREK = {
            1: { t: "Jhinu â†’ Bamboo", d: "é€”ç¶“ Chhomrong å¤§éšæ¢¯èˆ‡ Sinuwaã€‚é¦–æ—¥æµ·æ‹”çˆ¬å‡æ˜é¡¯ï¼Œéœ€æ³¨æ„ç¯€å¥ã€‚" },
            2: { t: "Bamboo â†’ ABC (4130m)", d: "æ­£å¼é€²å…¥é›ªå±±æ ¸å¿ƒå€ã€‚ç©¿é MBC æŠµé”å¤§æœ¬ç‡Ÿã€‚" },
            3: { t: "ABC â†’ è¿”å›æ³¢å¡æ‹‰", d: "æ—¥å‡ºå¾Œå¿«é€Ÿä¸‹æ’¤ï¼Œè½‰ä¹˜å‰æ™®è»Šè¿”å›å¸‚å€äº«ç”¨å¤§é¤ã€‚" }
        };

        // Initialize from localStorage safely
        let itinData = JSON.parse(localStorage.getItem('nepal_itin_v7')) || defaultItin;
        let expenses = JSON.parse(localStorage.getItem('nepal_exp_v7')) || [];
        let docs = JSON.parse(localStorage.getItem('nepal_docs_v7')) || [];

        function render() {
            // Itinerary
            document.getElementById('itin-list').innerHTML = itinData.map((item, i) => `
                <div class="flex items-center gap-4 p-4 bg-gray-50 rounded-2xl border-l-8 ${item.done ? 'border-green-400 opacity-50' : 'border-orange-400'}">
                    <input type="checkbox" ${item.done ? 'checked' : ''} onchange="toggleItin(${i})" class="w-5 h-5">
                    <div>
                        <span class="text-[10px] font-black text-orange-600 date-font">${item.d}</span>
                        <h4 class="font-bold text-sm ${item.done ? 'line-through' : ''}">${item.e}</h4>
                        <p class="text-[10px] text-gray-400 italic">${item.r}</p>
                    </div>
                </div>`).join('');

            // Locations
            const groups = SPOTS.reduce((acc, obj) => { acc[obj.c] = acc[obj.c] || []; acc[obj.c].push(obj); return acc; }, {});
            document.getElementById('loc-container').innerHTML = Object.entries(groups).map(([city, items]) => `
                <div class="bg-amber-50/50 p-6 rounded-[2rem] border border-amber-100">
                    <h3 class="font-black text-amber-900 mb-4 border-b border-amber-200 pb-2">${city}</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        ${items.map(s => `
                            <div class="bg-white p-4 rounded-xl shadow-sm flex justify-between items-end">
                                <div>
                                    <p class="text-xs font-black text-gray-800">${s.n}</p>
                                    <span class="text-[8px] bg-gray-100 px-2 py-0.5 rounded text-gray-400 font-bold uppercase">${s.t}</span>
                                </div>
                                <a href="#" class="text-[9px] font-black text-blue-500">MAP â†’</a>
                            </div>`).join('')}
                    </div>
                </div>`).join('');

            // Expenses
            const total = expenses.reduce((s, e) => s + e.amt, 0);
            document.getElementById('exp-total').innerText = `${total.toLocaleString()} NPR`;
            document.getElementById('exp-history').innerHTML = expenses.map(e => `
                <div class="flex justify-between bg-gray-50 p-2 rounded-lg text-[9px] font-bold">
                    <span>${e.item} (${e.use})</span>
                    <span>${e.amt}</span>
                </div>`).reverse().join('');

            // Files
            document.getElementById('file-list').innerHTML = docs.map((d, i) => `
                <div class="flex justify-between p-2 bg-yellow-50 rounded-lg text-[9px] font-black">
                    <a href="${d.data}" target="_blank">ğŸ“ ${d.name}</a>
                    <button onclick="delDoc(${i})" class="text-red-400">âœ•</button>
                </div>`).join('');

            save();
        }

        function save() {
            localStorage.setItem('nepal_itin_v7', JSON.stringify(itinData));
            localStorage.setItem('nepal_exp_v7', JSON.stringify(expenses));
            localStorage.setItem('nepal_docs_v7', JSON.stringify(docs));
        }

        window.toggleItin = (i) => { itinData[i].done = !itinData[i].done; render(); };
        window.convert = (s) => {
            const h = document.getElementById('hkd-in'), n = document.getElementById('nrs-in');
            if(s === 'HKD') n.value = (h.value * RATE).toFixed(0);
            else h.value = (n.value / RATE).toFixed(2);
        };
        window.showTrek = (d) => {
            document.getElementById('trek-title').innerText = TREK[d].t;
            document.getElementById('trek-desc').innerText = TREK[d].d;
        };
        window.addExp = () => {
            const amt = document.getElementById('exp-amt').value;
            const item = document.getElementById('exp-item').value;
            const use = document.getElementById('exp-use').value;
            if(!amt || !item) return;
            expenses.push({ amt: parseFloat(amt), item: item, use: use || 'N/A' });
            document.getElementById('exp-amt').value = ''; document.getElementById('exp-item').value = ''; render();
        };
        window.resetExp = () => { if(confirm("ç¢ºå®šé‡ç½®é–‹æ”¯ï¼Ÿ")) { expenses = []; render(); } };
        window.uploadFile = () => {
            const name = document.getElementById('file-name').value;
            const file = document.getElementById('file-input').files[0];
            if(!name || !file) return;
            const reader = new FileReader();
            reader.onload = (e) => { docs.push({ name: name, data: e.target.result }); render(); };
            reader.readAsDataURL(file);
        };
        window.delDoc = (i) => { docs.splice(i, 1); render(); };

        // Start App
        window.onload = render;
    </script>
</body>
</html>
