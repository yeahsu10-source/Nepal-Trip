<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nepal Trip - Final Deploy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #fcf6f0; }
        .abc-header { background-color: #88292F; border-bottom: 4px solid #FFD700; }
        .tool-card { @apply bg-white rounded-[2rem] shadow-xl border border-gray-100 overflow-hidden; }
    </style>
</head>
<body>

    <div id="app" class="max-w-6xl mx-auto p-4 space-y-8">
        <section class="abc-header p-8 rounded-[2rem] text-white shadow-2xl">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-black">ğŸ”ï¸ ABC æ¥µé™å¾’æ­¥</h1>
                <div class="flex gap-2">
                    <button onclick="showTrek(1)" class="bg-white text-red-900 px-4 py-1 rounded-full font-black text-xs">D1</button>
                    <button onclick="showTrek(2)" class="bg-white/20 px-4 py-1 rounded-full font-black text-xs">D2</button>
                    <button onclick="showTrek(3)" class="bg-white/20 px-4 py-1 rounded-full font-black text-xs">D3</button>
                </div>
            </div>
            <div class="mb-6">
                <h2 id="trek-title" class="text-xl font-bold text-yellow-400">Jhinu â†’ Bamboo</h2>
                <p id="trek-desc" class="text-sm opacity-90">é€”ç¶“ Chhomrong å¤§éšæ¢¯èˆ‡ Sinuwaã€‚</p>
            </div>
            <div class="bg-black/20 p-4 rounded-xl text-[11px] space-y-1">
                <p>Sinuwa: Sinuwaa123 | Bamboo: Bamboo222</p>
                <p>Himalaya: man9766027280 | ABC: blacktea1234</p>
            </div>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2 space-y-8">
                <section class="bg-white p-6 rounded-[2rem] shadow-xl border-t-8 border-orange-500">
                    <h2 class="text-xl font-black mb-4">ğŸ“… è¡Œç¨‹ç®¡ç†</h2>
                    <div id="itin-list" class="space-y-3"></div>
                </section>
                <div id="loc-container" class="space-y-6"></div>
            </div>

            <div class="space-y-6">
                <div class="tool-card p-6 border-t-8 border-blue-500">
                    <h3 class="font-black text-blue-600 mb-4">Wise Rate (18.55)</h3>
                    <input type="number" id="hkd-in" oninput="convert('HKD')" placeholder="HKD" class="w-full p-2 bg-gray-50 rounded-lg mb-2">
                    <input type="number" id="nrs-in" oninput="convert('NRs')" placeholder="NPR" class="w-full p-2 bg-gray-50 rounded-lg">
                </div>
                <div class="tool-card border-t-8 border-teal-600 p-6">
                    <div class="flex justify-between mb-4"><span class="font-black">EXPENSES</span><span id="exp-total" class="text-teal-600 font-bold">0</span></div>
                    <input type="text" id="exp-item" placeholder="é …ç›®" class="w-full p-2 bg-gray-50 rounded-lg mb-2 text-sm">
                    <input type="number" id="exp-amt" placeholder="é‡‘é¡" class="w-full p-2 bg-gray-50 rounded-lg mb-2 text-sm">
                    <button onclick="addExp()" class="w-full bg-teal-700 text-white py-2 rounded-lg font-bold text-xs">SAVE</button>
                    <div id="exp-history" class="mt-4 space-y-1 text-[10px] max-h-32 overflow-y-auto"></div>
                    <button onclick="resetExp()" class="w-full text-red-400 text-[10px] mt-2">RESET ALL</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const RATE = 18.55;
        const defaultItin = [
            { d: "12/19", e: "é¦™æ¸¯ â†’ æ˜†æ˜", r: "21:15 å‡ºç™¼", done: false },
            { d: "12/20", e: "åŠ å¾·æ»¿éƒ½ â†’ æ³¢å¡æ‹‰", r: "è½‰æ©Ÿ", done: false },
            { d: "12/21", e: "ABC D1", r: "Jhinu âœ Sinuwa", done: false },
            { d: "12/22", e: "ABC D2", r: "4130m å¤§æœ¬ç‡Ÿ", done: false },
            { d: "12/23", e: "ABC D3", r: "ä¸‹æ’¤è¿”åŸ", done: false }
        ];

        let itinData = JSON.parse(localStorage.getItem('nepal_v8')) || defaultItin;
        let expenses = JSON.parse(localStorage.getItem('exp_v8')) || [];

        function render() {
            const list = document.getElementById('itin-list');
            if (list) {
                list.innerHTML = itinData.map((item, i) => `
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl border-l-4 ${item.done ? 'border-green-400 opacity-50' : 'border-orange-400'}">
                        <input type="checkbox" ${item.done ? 'checked' : ''} onchange="toggleItin(${i})">
                        <div class="text-xs font-bold">${item.e} <span class="text-gray-400 font-normal">(${item.d})</span></div>
                    </div>`).join('');
            }

            document.getElementById('exp-total').innerText = expenses.reduce((s, e) => s + e.amt, 0).toLocaleString();
            document.getElementById('exp-history').innerHTML = expenses.map(e => `<div>${e.item}: ${e.amt}</div>`).reverse().join('');
            
            localStorage.setItem('nepal_v8', JSON.stringify(itinData));
            localStorage.setItem('exp_v8', JSON.stringify(expenses));
        }

        window.toggleItin = (i) => { itinData[i].done = !itinData[i].done; render(); };
        window.convert = (s) => {
            const h = document.getElementById('hkd-in'), n = document.getElementById('nrs-in');
            if(s === 'HKD') n.value = (h.value * RATE).toFixed(0);
            else h.value = (n.value / RATE).toFixed(2);
        };
        window.addExp = () => {
            const amt = document.getElementById('exp-amt').value;
            const item = document.getElementById('exp-item').value;
            if(!amt || !item) return;
            expenses.push({ amt: parseFloat(amt), item: item });
            render();
        };
        window.resetExp = () => { if(confirm("Reset?")) { expenses = []; render(); } };

        // Force render on start
        document.addEventListener('DOMContentLoaded', render);
        window.onload = render;
    </script>
</body>
</html>
